<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HBD Khari Jii ❤</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --rpg-blue: #000080;
            --rpg-border: #ffffff;
            --stone-dark: #1a1a1a;
            --stone-light: #2a2a2a;
        }

        /* Loading Screen Styling */
        #loading-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 2000;
            font-family: 'Press Start 2P', cursive;
        }
        .loader-bar {
            width: 300px; height: 30px;
            border: 4px solid #fff;
            background: #222;
            margin-top: 20px;
            position: relative;
        }
        #p-bar { width: 0%; height: 100%; background: #00ff00; transition: 0.2s; }

        body {
            background-color: #0e0e0e;
            background-image: 
                linear-gradient(90deg, #161616 2px, transparent 2px),
                linear-gradient(#161616 2px, transparent 2px),
                linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 100px 100px, 100px 100px, 20px 20px, 20px 20px;
            color: white;
            font-family: 'Press Start 2P', cursive;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            min-height: 100vh; margin: 0; overflow: hidden;
            transition: background 0.8s ease;
        }

        body.mode-active {
            background-color: #2c1e14;
            background-image: 
                linear-gradient(45deg, #3d2b1f 25%, transparent 25%), 
                linear-gradient(-45deg, #3d2b1f 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #3d2b1f 75%), 
                linear-gradient(-45deg, transparent 75%, #3d2b1f 75%);
            background-size: 40px 40px;
        }

        .main-title {
            color: #ffcc00;
            text-shadow: 4px 4px #cc0000;
            font-size: 20px;
            margin-bottom: 25px;
            z-index: 100;
        }

        /* 3:2 Aspect Ratio Frame */
        .game-container {
            position: relative;
            width: 900px; height: 600px;
            border: 8px solid #8b5a2b;
            border-style: outset;
            background: url('background.jpg') no-repeat center center;
            background-size: cover;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 80px rgba(0,0,0,1);
            z-index: 50; overflow: hidden;
        }

        video {
            position: absolute;
            width: 100%; height: 100%;
            object-fit: contain;
            background: black;
            display: none;
            z-index: 60;
        }

        /* Secret Message RPG Box */
        #secret-box {
            position: fixed;
            bottom: 50px;
            width: 80%; max-width: 700px;
            background: var(--rpg-blue);
            border: 6px double var(--rpg-border);
            padding: 25px; display: none;
            z-index: 200; line-height: 1.8;
            font-size: 14px; text-align: left;
        }

        .falling-text {
            position: fixed; top: -50px;
            color: #ffcc00; font-size: 10px;
            z-index: 10; animation: fall linear forwards;
            pointer-events: none;
        }

        @keyframes fall { to { transform: translateY(110vh); } }

        .controls { margin-top: 25px; display: none; gap: 15px; z-index: 100; }

        .game-btn {
            font-family: 'Press Start 2P', cursive;
            padding: 12px 18px; cursor: pointer;
            border: 4px solid #fff; background: #000;
            color: #fff; font-size: 10px;
        }

        #start-btn {
            z-index: 70; padding: 25px 50px;
            font-size: 28px; background: #cc0000;
            color: white; border: 8px ridge #660000;
            cursor: pointer;
        }

        .balloon {
            position: absolute; width: 60px; height: 80px;
            border-radius: 50%; cursor: pointer;
            z-index: 80; animation: float 4s infinite ease-in-out;
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-30px); } }
    </style>
</head>
<body>

    <div id="loading-screen">
        <p>PREPARING ADVENTURE...</p>
        <div class="loader-bar"><div id="p-bar"></div></div>
    </div>

    <div class="main-title">HAPPY BDAY KHARI JII</div>

    <div class="game-container" id="screen">
        <video id="video-element" preload="auto" playsinline>
            <source id="video-source" src="celebration.mp4" type="video/mp4">
        </video>
        <button id="start-btn" onclick="initGame()">▶ START GAME</button>
    </div>

    <div class="controls" id="ui-controls">
        <button class="game-btn" onclick="togglePause()">PAUSE/PLAY</button>
        <button class="game-btn" onclick="restartVideo()">RESTART</button>
        <button class="game-btn" onclick="toggleFullScreen()">FULLSCREEN</button>
        <button class="game-btn" onclick="playCelebration()">CELEBRATION</button>
        <button class="game-btn" onclick="playMoments()">MOMENTS</button>
    </div>

    <div id="secret-box">
        I hope you liked it. Best Wishes for today. You will do great in your life. Always keep smiling.....
        <br><br><span style="font-size: 10px; color: #aaa;">(Click to close)</span>
    </div>

    <audio id="pop-sound" src="https://www.soundjay.com/buttons/sounds/button-10.mp3" preload="auto"></audio>

    <script>
        const video = document.getElementById('video-element');
        const source = document.getElementById('video-source');
        const pBar = document.getElementById('p-bar');
        const loadingScreen = document.getElementById('loading-screen');
        
        let balloonsToPop = 12;
        let poppedCount = 0;

        // Progress Bar Logic
        video.addEventListener('progress', () => {
            if (video.buffered.length > 0) {
                const percent = (video.buffered.end(0) / video.duration) * 100;
                pBar.style.width = percent + "%";
            }
        });

        // Hide loader when video is ready
        video.oncanplaythrough = () => {
            pBar.style.width = "100%";
            setTimeout(() => { loadingScreen.style.display = 'none'; }, 800);
        };

        function initGame() {
            document.getElementById('start-btn').style.display = 'none';
            document.getElementById('ui-controls').style.display = 'flex';
            document.body.classList.add('mode-active');
            spawnBalloons(balloonsToPop);
            setInterval(createFallingText, 2500);
            video.style.display = 'block';
            video.play();
        }

        function spawnBalloons(num) {
            const colors = ['#ff69b4', '#00ff00', '#00ffff', '#ffff00', '#ff4500'];
            for (let i = 0; i < num; i++) {
                const b = document.createElement('div');
                b.className = 'balloon';
                b.style.backgroundColor = colors[i % colors.length];
                b.style.left = Math.random() * 85 + '%';
                b.style.top = Math.random() * 75 + '%';
                b.onclick = function() {
                    document.getElementById('pop-sound').play();
                    this.style.transform = 'scale(0)';
                    poppedCount++;
                    setTimeout(() => { this.remove(); checkSecretMessage(); }, 200);
                };
                document.getElementById('screen').appendChild(b);
            }
        }

        function checkSecretMessage() {
            if (poppedCount === balloonsToPop) {
                document.getElementById('secret-box').style.display = 'block';
            }
        }

        document.getElementById('secret-box').onclick = function() { this.style.display = 'none'; };

        function playCelebration() { source.src = "celebration.mp4"; video.load(); video.play(); }
        function playMoments() { source.src = "moments.mp4"; video.load(); video.play(); }
        function togglePause() { video.paused ? video.play() : video.pause(); }
        function restartVideo() { video.currentTime = 0; video.play(); }
        function toggleFullScreen() {
            const sc = document.getElementById('screen');
            if (!document.fullscreenElement) sc.requestFullscreen();
            else document.exitFullscreen();
        }
    </script>
</body>
</html>
